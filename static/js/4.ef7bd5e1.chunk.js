(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{742:function(e,t,n){e.exports=n.p+"static/media/optic-contract-testing-diagram.9124d728.svg"},749:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n.n(a),i=n(9),o=n(8),c=n(0),s=n.n(c),l=n(26),u=n(727),p=n(55),d=n(364),m=n(62),f=n.n(m),h=n(29),g=n(28),b=n(99),v=n(3),y=n(18),E=n(728),j=n.n(E),O=n(731),w=n(732),x=n(741),k=n(96),C=n(15),N=n(17),T=n(21),I=n(22),R=n(744),S=Symbol("testing-service-error"),A=function(e){Object(T.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(C.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).statusCode=404,e}return n}(function(e){Object(T.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(C.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).statusCode=void 0,e.type=S,e}return Object(N.a)(n,[{key:"notFound",value:function(){return 404===this.statusCode}}],[{key:"instanceOf",value:function(e){return e&&e.type===S}}]),n}(Object(R.a)(Error))),L=function(){function e(t){Object(C.a)(this,e),this.value=t}return Object(N.a)(e,[{key:"isOk",value:function(){return!0}},{key:"isErr",value:function(){return!this.isOk()}},{key:"unwrap",value:function(){return this.value}},{key:"unwrapErr",value:function(){throw new Error("Cannot unwrap error on Ok")}}]),e}(),D=function(){function e(t){Object(C.a)(this,e),this.error=t}return Object(N.a)(e,[{key:"isOk",value:function(){return!this.isErr()}},{key:"isErr",value:function(){return!0}},{key:"unwrap",value:function(){throw this.error}},{key:"unwrapErr",value:function(){return this.error}}]),e}();function F(e){return new L(e)}function P(e){return new D(e)}var U=n(186);function M(){return q.apply(this,arguments)}function q(){return(q=Object(i.a)(r.a.mark((function e(){var t,n,a,o,c,s,l,u,p,d,m=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=function(){return new A},u=function(e){var t=c[e];return"string"===typeof t?u(t):t},l=function(e){var t=o[e];return"string"===typeof t?l(t):t},t=m.length>0&&void 0!==m[0]?m[0]:"todo-report",e.next=6,fetch("/example-reports/".concat(t,".json"),{headers:{accept:"application/json"}}).then((function(e){if(e.ok)return e.json();throw new Error}));case 6:return n=e.sent,a=n.orgId,o=n.specs,c=n.samples,s=n.captures,d=function(){function e(t){Object(C.a)(this,e),this.orgId=void 0,this.orgId=t}return Object(N.a)(e,[{key:"loadSpecEvents",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,200)}));case 2:if(n=l(t)){e.next=5;break}return e.abrupt("return",P(p()));case 5:return e.abrupt("return",F(n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCaptures",value:function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,400)}));case 2:return e.abrupt("return",F(s.map((function(e){return{captureId:e.captureId,createdAt:e.createdAt,updatedAt:e.updatedAt,completedAt:e.completedAt,tags:e.tags.map((function(e){return{name:e.name,value:e.value}}))}}))));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCapture",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,200)}));case 2:if(n=s.find((function(e){return t===e.captureId}))){e.next=5;break}return e.abrupt("return",P(p()));case 5:return e.abrupt("return",F(n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadReport",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,o,c,s,d,m,f,h,g,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,2e3)}));case 2:if(n=l(t),a=u(t),n&&a){e.next=6;break}return e.abrupt("return",P(p()));case 6:i=H(n),o=i.rfcState,c=i.queries,s=c.shapesResolvers(),d=v.JsonHelper.jsArrayToSeq(a.map((function(e){return v.JsonHelper.fromInteraction(e)}))),m=new v.opticEngine.com.useoptic.CoverageReportConverter(U.StableHasher),f=v.opticEngine.com.useoptic.diff.helpers.CoverageHelpers().getCoverage(s,o,d);try{h=v.opticEngine.CoverageReportJsonSerializer.toJs(f),console.log({asJs:h}),g=v.opticEngine.CoverageReportJsonDeserializer.fromJs(h),console.log({fromJs:g})}catch(r){}return b=m.toJs(f),e.abrupt("return",F(b));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadEndpointDiffs",value:function(){var e=Object(i.a)(r.a.mark((function e(t,n,a){var i,o,c,s,d,m,f,h,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l(t),o=u(t),i&&o){e.next=4;break}return e.abrupt("return",P(p()));case 4:return c=H(i),s=c.rfcState,d=c.queries,m=d.shapesResolvers(),v.JsonHelper.jsArrayToSeq(o.map((function(e){return v.JsonHelper.fromInteraction(e)}))),(f=v.DiffManagerFacade.newFromInteractions(o,(function(){}))).updatedRfcState(s,m),h=f.managerForPathAndMethod(n,a,v.JsonHelper.jsArrayToSeq([])),g=h.diffRegions,e.abrupt("return",F({newRegions:v.JsonHelper.seqToJsArray(g.newRegions),bodyDiffs:v.JsonHelper.seqToJsArray(g.bodyDiffs)}));case 12:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"loadUndocumentedEndpoints",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,o,c,s,d,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,200)}));case 2:if(n=l(t),a=u(t),n&&a){e.next=6;break}return e.abrupt("return",P(p()));case 6:return i=H(n),o=i.rfcState,c=i.queries,s=c.shapesResolvers(),(d=v.DiffManagerFacade.newFromInteractions(a,(function(){}))).updatedRfcState(o,s),m=d.unmatchedUrls(!0),e.abrupt("return",F(v.JsonHelper.seqToJsArray(m).map((function(e){return{method:e.method,path:e.path,pathId:e.pathId,count:e.count}}))));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),e.abrupt("return",new d(a));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){var t=(0,v.opticEngine.com.useoptic.contexts.rfc.RfcServiceJSFacade)(),n=t.makeEventStore(),a=v.opticEngine.EventSerialization.fromJs(e);n.append("testRfcId",a);var r=t.makeRfcService(n);return{queries:Object(v.Queries)(n,r,"testRfcId"),rfcState:r.currentState("testRfcId")}}var J=s.a.createContext(null),z=J.Provider;function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(c.useContext)(J),a=n.service,r=Object(c.useRef)(1),i=Object(c.useReducer)(G,(r.current,{loading:!1,result:null,error:null,notFound:!1})),s=Object(o.a)(i,2),u=s[0],p=s[1],d=Object(c.useRef)(!1);return Object(c.useEffect)((function(){var t=r.current;function n(e){return p(Object(l.a)(Object(l.a)({},e),{},{version:t,latestVersion:r.current}))}return n({type:"request"}),e(a).then((function(e){if(!d.current)if(e.isOk())n({type:"receive_success",payload:e.value});else{var t=e.unwrapErr();t.notFound()?n({type:"receive_not_found"}):n({type:"receive_error",payload:t})}})),function(){r.current++}}),t),Object(c.useEffect)((function(){return function(){d.current=!0}}),[]),u}function W(e){var t=Object(c.useContext)(J).baseUrl;return"".concat(t,"/captures/").concat(e)}function G(e,t){if(t.version!==t.latestVersion)return e;switch(t.type){case"request":return Object(l.a)(Object(l.a)({},{loading:!1,result:null,error:null,notFound:!1}),{},{loading:!0});case"receive_success":return e.loading?Object(l.a)(Object(l.a)({},e),{},{result:t.payload,loading:!1}):e;case"receive_not_found":return e.loading?Object(l.a)(Object(l.a)({},e),{},{loading:!1,result:null,notFound:!0}):e;case"receive_error":return e.loading?Object(l.a)(Object(l.a)({},e),{},{loading:!1,result:null,error:t.payload}):e;default:throw new Error("Unknown action type '".concat(t.type,"' for service state reducer"))}}var $=n(272),_=n.n($),V=n(263),X=n(730),Q=n.n(X),Y=n(138),K=n.n(Y),Z=n(268),ee=n(100),te=n(49);function ne(e){var t=e.captureId,n=Object(u.a)(e,["captureId"]),a=W(t);return s.a.createElement(te.c,Object.assign({},n,{to:a}))}var ae=n(740),re=n.n(ae),ie=n(188),oe=n.n(ie),ce=n(273);function se(e){var t=e.captureId,n=e.endpoint,a=B((function(e){return e.loadEndpointDiffs(t,n.pathId,n.method)})),r=a.error,i=a.loading,o=a.result,u=Object(c.useMemo)((function(){return o?function(e){var t=e.bodyDiffs,n=e.newRegions,a=n.filter(p),r=t.filter(p),i=n.filter(u),o=t.filter(u),c={regionDiffs:i.map(h),bodyDiffs:o.map(f),unmatchedContentTypes:i.filter(m).map(m)},s={regionDiffs:a.map(h),bodyDiffs:r.map(f),unmatchedStatusCodes:a.filter(d).map(d),unmatchedContentTypes:a.filter(m).map(m)};return{totalCount:t.length+n.length,responses:Object(l.a)(Object(l.a)({},s),{},{count:s.regionDiffs.length+s.bodyDiffs.length}),requests:Object(l.a)(Object(l.a)({},c),{},{count:c.regionDiffs.length+c.bodyDiffs.length})};function u(e){return e.inRequest}function p(e){return e.inResponse}function d(e){return e.statusCode}function m(e){return e.contentType}function f(e){var t=Object(v.getIndex)(e.interactions)(0),n=e.inRequest?t.request.body:t.response.body;return{id:e.toString(),assertion:e.description.assertion,contentType:Object(v.getOrUndefined)(n.contentType),count:1,changeType:e.description.changeTypeAsString,path:v.JsonHelper.seqToJsArray(e.description.path),summary:e.description.summary,statusCode:e.inResponse?t.response.statusCode:null}}function h(e){return{id:e.toString(),count:1,contentType:Object(v.getOrUndefined)(e.contentType),statusCode:Object(v.getOrUndefined)(e.statusCode),changeType:e.description.changeTypeAsString,summary:e.description.summary||e.description.assertion}}}(o):null}));if(r)throw r;return s.a.createElement(le,{endpointCounts:n.counts,endpointPurpose:n.descriptor.endpointPurpose,loadingDiffsSummary:i,diffsSummary:u})}function le(e){var t=e.diffsSummary,n=e.endpointPurpose,a=(e.endpointCounts,me()),r=function(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){if(e){if(!t.current)throw Error("Ref must be set to DOM node in order to scroll it into view upon activation");Object(ce.a)(t.current,{scrollMode:"if-needed",block:"center"})}}),[e]),t}(!0);return s.a.createElement("div",{ref:r,className:a.root},s.a.createElement("h6",{className:a.endpointPurpose},n),t&&s.a.createElement(ue,{diffsSummary:t}))}function ue(e){var t=e.diffsSummary,n=t.responses,a=t.requests,r=me();return t.totalCount<1?s.a.createElement("div",null,"No diffs!"):s.a.createElement("div",{className:r.diffsContainer},a.count>0&&s.a.createElement("div",{className:f()(r.diffs,r.requestDiffs)},s.a.createElement("h4",{className:r.diffsLocationHeader},"Requests"),s.a.createElement(s.a.Fragment,null,a.regionDiffs.length>0&&s.a.createElement("ul",{className:r.diffsList},a.regionDiffs.map((function(e){return s.a.createElement("li",{key:e.id,className:r.diffsListItem},s.a.createElement(pe,{contentType:e.contentType,statusCode:e.statusCode,count:e.count,inResponse:!0}))}))),a.bodyDiffs.length>0&&s.a.createElement("ul",{className:r.diffsList},a.bodyDiffs.map((function(e){return s.a.createElement("li",{key:e.id,className:r.diffsListItem},s.a.createElement(de,{assertion:e.assertion,changeType:e.changeType,count:e.count,contentType:e.contentType,path:e.path,inRequest:!0}))}))))),n.count>0&&s.a.createElement("div",{className:f()(r.diffs,r.responseDiffs)},s.a.createElement("h4",{className:r.diffsLocationHeader},"Responses"),s.a.createElement(s.a.Fragment,null,n.regionDiffs.length>0&&s.a.createElement("ul",{className:r.diffsList},n.regionDiffs.map((function(e){return s.a.createElement("li",{key:e.id,className:r.diffsListItem},s.a.createElement(pe,{contentType:e.contentType,statusCode:e.statusCode,count:e.count,inResponse:!0}))}))),n.bodyDiffs.length>0&&s.a.createElement("ul",{className:r.diffsList},n.bodyDiffs.map((function(e){return s.a.createElement("li",{key:e.id,className:r.diffsListItem},s.a.createElement(de,{assertion:e.assertion,changeType:e.changeType,count:e.count,contentType:e.contentType,path:e.path,statusCode:e.statusCode,inResponse:!0}))}))))))}function pe(e){var t=e.contentType,n=e.count,a=e.statusCode,r=e.inRequest,i=e.inResponse,o=me();return s.a.createElement("div",{className:o.diffContainer},s.a.createElement("div",{className:o.diffDescription},r&&s.a.createElement(s.a.Fragment,null,"Undocumented Request type (",s.a.createElement("code",null,t),")"),i&&s.a.createElement(s.a.Fragment,null,"Undocumented ",s.a.createElement("code",null,a)," Response type (",s.a.createElement("code",null,t),")")),s.a.createElement("small",{className:o.diffMeta},i?"new combination of status code and content type":"new content type"," ","observed ",s.a.createElement("strong",null,n>1?"".concat(n," times"):"once")))}function de(e){var t=e.assertion,n=(e.changeType,e.contentType),a=e.count,r=e.inRequest,i=e.inResponse,o=e.path,c=e.statusCode,l=me();return s.a.createElement("div",{className:l.diffContainer},s.a.createElement("div",{className:l.diffDescription},r&&s.a.createElement(s.a.Fragment,null,"Shape mismatch in Request body (",s.a.createElement("code",null,n),")"),i&&s.a.createElement(s.a.Fragment,null,"Shape mismatch in ",s.a.createElement("code",null,c)," Response body (",s.a.createElement("code",null,n),"):")),s.a.createElement("small",{className:l.diffMeta},"difference with documentated shape observed"," ",s.a.createElement("strong",null,a>1?"".concat(a," times"):"once")),s.a.createElement("div",{className:l.diffFieldTrail},s.a.createElement("div",{className:l.diffFieldTrailRoot},s.a.createElement("code",null,c," ",i?"Response":"Request"," Body")),s.a.createElement("ul",{className:l.diffFieldTrailComponents},o.map((function(e,n,a){return s.a.createElement("li",{className:l.diffFieldTrailComponent,key:e},s.a.createElement(re.a,{className:l.diffFieldTrailSeparator}),s.a.createElement("code",null,e),n===a.length-1&&s.a.createElement("div",{className:l.diffFieldTrailAssertion},s.a.createElement(oe.a,{className:l.diffFielTrailWarningIcon}),t))})))))}var me=Object(b.a)((function(e){return{root:{padding:e.spacing(0,2)},endpointPurpose:Object(l.a)(Object(l.a)({},e.typography.h6),{},{margin:0}),diffsContainer:{},diffs:{marginBottom:e.spacing(4)},diffsLocationHeader:Object(l.a)(Object(l.a)({},e.typography.overline),{},{margin:e.spacing(2,0,3),color:j()(e.palette.primary.main).desaturate(.55).lighten(1.2).hex(),borderBottom:"1px solid ".concat(j()(e.palette.primary.main).desaturate(.55).lighten(1.9).hex())}),diffsList:{padding:0,listStyleType:"none"},diffsListItem:{marginBottom:e.spacing(4)},diffDescription:{fontSize:e.typography.pxToRem(e.typography.fontSize+1),"& code":{color:e.palette.primary.main}},diffMeta:Object(l.a)(Object(l.a)({},e.typography.subtitle2),{},{color:e.palette.grey[600],fontWeight:e.typography.fontWeightLight,fontSize:e.typography.pxToRem(12)}),diffFieldTrail:{padding:e.spacing(1.5,2,0,1.5),marginLeft:2,borderLeft:"8px solid ".concat(e.palette.grey[50]),display:"flex",alignItems:"flex-start",alignContent:"baseline",fontSize:e.typography.pxToRem(e.typography.fontSize-1)},diffFieldTrailRoot:{display:"flex",flexGrow:0,flexShrink:0,alignItems:"center","& code":{padding:e.spacing(.5,1),color:e.palette.primary.light,background:e.palette.grey[100]}},diffFieldTrailComponents:{display:"flex",alignItems:"center",padding:0,flexWrap:"wrap",listStyleType:"none"},diffFieldTrailComponent:{display:"flex",flexGrow:0,flexShrink:0,marginBottom:e.spacing(1),alignItems:"center","& code":{padding:e.spacing(.5,1),color:e.palette.primary.light,background:e.palette.grey[100]},"&:last-child code":{background:j()(e.palette.error.light).lighten(.3).hex(),color:j()(e.palette.error.dark).darken(.5).hex()}},diffFieldTrailAssertion:{display:"flex",alignItems:"center",padding:e.spacing(.5,1),color:j()(e.palette.error.dark).darken(.2).hex()},diffFielTrailWarningIcon:{width:20,height:20,marginRight:e.spacing(1),color:j()(e.palette.removed.main).darken(.3).hex()},diffFieldTrailSeparator:{width:e.typography.pxToRem(e.typography.fontSize+2),color:e.palette.grey[400]}}}));function fe(e){var t=e.capture,n=e.report,a=e.spec,r=e.currentEndpointId,i=ve(),o=ye(),l=t.captureId,u=W(l),d=Object(c.useMemo)((function(){return function(e,t,n){var a=t.apiName,r=t.endpoints,i=d(Ee.TotalInteractions()),o=d(Ee.TotalUnmatchedPath()),c=r.map((function(e,n){var a=Object(V.a)(e,t),r=Object(V.b)(e),i=a.pathId,o=a.httpMethod,c=d(Ee.TotalForPathAndMethod(i,o)),s=d(Ee.TotalForPathAndMethodWithoutDiffs(i,o)),l=c-s,u=l*(n%3===0?1:2);return{id:r,pathId:e.pathId,method:e.method,descriptor:a,counts:{interactions:c,diffs:u,compliant:s,incompliant:l}}})),s=c.map((function(e){return e.counts.diffs})).reduce((function(e,t){return e+t}),0),l=i-s,u=e.tags.find((function(e){return"buildId"===e.name})),p=e.tags.find((function(e){return"environmentName"===e.name}));return{apiName:a,createdAt:m(e.createdAt),updatedAt:m(e.updatedAt),completedAt:m(e.completedAt),isCapturing:!e.completedAt,buildId:u&&u.value||"",environment:p&&p.value||"",endpoints:_()(c,(function(e){return-e.counts.incompliant}),(function(e){return s-e.counts.diffs}),(function(e){return e.descriptor.fullPath}),(function(e){return e.method})),totalInteractions:i,totalUnmatchedPaths:o,totalDiffs:s,totalCompliantInteractions:l};function d(e){var t=U.StableHasher.hash(e);return n.coverageCounts[t]||0}function m(e){return e&&Object(x.a)(e)}}(t,a,n)}),[t,a,n]),m=Object(g.g)(),h=Object(c.useCallback)((function(e){e.stopPropagation()})),b=Object(c.useCallback)((function(e){m.replace(u)})),v=Object(c.useMemo)((function(){return _()(e.undocumentedEndpoints,(function(e){return-e.count}),(function(e){return e.path}),(function(e){return e.method}))}),[e.undocumentedEndpoints]),y=d.endpoints,E=(d.isCapturing,d.totalInteractions),j=(d.totalCompliantInteractions,d.totalDiffs),C=d.totalUnmatchedPaths,N=new Date;return Object(k.b)(d.buildId&&d.environment?"Report for '".concat(d.buildId,"' in '").concat(d.environment,"'"):"Report"),s.a.createElement("div",{className:i.root,onClick:b},s.a.createElement("div",{className:i.reportMeta},s.a.createElement("div",{className:i.captureTime},d.isCapturing?s.a.createElement("div",{className:i.liveIndicator},s.a.createElement(K.a,{className:i.recordIcon}),s.a.createElement("span",{className:i.liveLabel},"LIVE")):s.a.createElement(Q.a,{className:i.historyIcon}),d.isCapturing?s.a.createElement(s.a.Fragment,null,"since ",Object(O.a)(d.createdAt,N)):s.a.createElement(s.a.Fragment,null,"ended ",Object(O.a)(d.completedAt,N)," after"," ",Object(w.a)(d.completedAt,d.createdAt)))),s.a.createElement("div",{className:i.stats},s.a.createElement(he,{totalInteractions:E,totalDiffs:j,totalUnmatchedPaths:C,totalUndocumentedEndpoints:v.length}),s.a.createElement("h4",{className:i.buildName},"from capturing interactions for build ",s.a.createElement("code",null,d.buildId)," ","in ",s.a.createElement("code",null,d.environment))),s.a.createElement("h4",{className:i.endpointsHeader},"Endpoints"),y.length>0?s.a.createElement("ul",{className:i.endpointsList,onClick:h},y.map((function(e){var t=s.a.createElement("div",{className:i.endpointHeader},s.a.createElement("span",{className:f()(i.endpointMethod,o[e.descriptor.httpMethod])},e.descriptor.httpMethod),s.a.createElement("code",{className:i.endpointPath},e.descriptor.fullPath),s.a.createElement("div",{className:i.endpointStats},e.counts.diffs>0&&!1,e.counts.incompliant>0?s.a.createElement("span",{className:f()(i.endpointChip,i.endpointIncompliantChip)},s.a.createElement("strong",null,e.counts.incompliant,"/",e.counts.interactions)," incompliant"):s.a.createElement("span",{className:f()(i.endpointChip,i.endpointCompliantChip)},s.a.createElement("strong",null,e.counts.compliant,"/",e.counts.interactions)," compliant")));return s.a.createElement("li",{key:e.id,className:f()(i.endpointsListItem,Object(p.a)({},i.isCurrent,r&&e.id===r))},s.a.createElement(Z.a,{className:i.endpointCard},s.a.createElement("div",{className:i.endpointLink},t),r&&e.id===r&&s.a.createElement(se,{endpoint:e,captureId:l})))}))):s.a.createElement("p",null,"No endpoints have been documented yet"),!1)}function he(e){var t=e.totalInteractions,n=e.totalDiffs,a=e.totalUnmatchedPaths,r=(e.totalUndocumentedEndpoints,ve(),s.a.createElement(s.a.Fragment,null,"of which"," ",s.a.createElement(ge,{value:n,label:"incompliant",pluralize:!1}))),i=s.a.createElement(s.a.Fragment,null,s.a.createElement(ge,{value:a,label:"against undocumented endpoints",pluralize:!1}));return s.a.createElement(y.a,{variant:"h6",color:"primary",style:{fontWeight:200}},"Optic observed ",s.a.createElement(ge,{value:t,label:"interaction"}),","," ",r," and ",i,".")}function ge(e){var t=e.value,n=void 0===t?0:t,a=e.label,r=void 0===a?"":a,i=e.pluralize,o=void 0===i||i;return s.a.createElement("span",null,0!==n&&s.a.createElement(y.a,{variant:"h6",component:"span",color:"secondary",style:{fontWeight:800}},n," "),s.a.createElement(y.a,{variant:"h6",component:"span",style:{fontWeight:800}},0===n&&"no ",r,o&&1!==n?"s":""))}function be(){var e=ve();return s.a.createElement("div",{className:e.root},s.a.createElement("div",{className:e.reportMeta},s.a.createElement(ee.a,{width:"20%",height:"1rem"})),s.a.createElement("div",{className:e.stats},s.a.createElement(ee.a,{width:"100%",height:"2.8rem"}),s.a.createElement(ee.a,{width:"30%",height:"2.8rem"}),s.a.createElement("h4",{className:e.buildName},s.a.createElement(ee.a,{width:"60%",height:"1.5rem"}))),s.a.createElement(ee.a,{width:"85px",height:"1rem"}),s.a.createElement("ul",{className:e.endpointsList},s.a.createElement("li",{className:e.endpointsListItem},s.a.createElement("div",{className:e.endpointHeader},s.a.createElement("span",{className:e.endpointMethod},s.a.createElement(ee.a,{width:"40px",height:"2rem"})),s.a.createElement("span",{className:e.endpointPath},s.a.createElement(ee.a,{width:"70%",height:"2rem"})),s.a.createElement("div",{className:e.endpointStats},s.a.createElement(ee.a,{width:"45px",height:"2rem",style:{marginRight:8}}),s.a.createElement(ee.a,{width:"58px",height:"2rem"})))),s.a.createElement("li",{className:e.endpointsListItem},s.a.createElement("div",{className:e.endpointHeader},s.a.createElement("span",{className:e.endpointMethod},s.a.createElement(ee.a,{width:"40px",height:"2rem"})),s.a.createElement("span",{className:e.endpointPath},s.a.createElement(ee.a,{width:"60%",height:"2rem"})),s.a.createElement("div",{className:e.endpointStats},s.a.createElement(ee.a,{width:"40px",height:"2rem",style:{marginRight:8}}),s.a.createElement(ee.a,{width:"50px",height:"2rem"})))),s.a.createElement("li",{className:e.endpointsListItem},s.a.createElement("div",{className:e.endpointHeader},s.a.createElement("span",{className:e.endpointMethod},s.a.createElement(ee.a,{width:"40px",height:"2rem"})),s.a.createElement("span",{className:e.endpointPath},s.a.createElement(ee.a,{width:"60%",height:"2rem"})),s.a.createElement("div",{className:e.endpointStats},s.a.createElement(ee.a,{width:"40px",height:"2rem"}))))))}fe.displayName="Testing/ReportSummary",he.displayName="Testing/ReportSummary/SummaryStats";var ve=Object(b.a)((function(e){return{root:{padding:e.spacing(3,4),maxWidth:e.breakpoints.values.lg,flexGrow:1},reportMeta:{display:"flex",flexDirection:"row",justifyContent:"flex-end",marginBottom:e.spacing(3)},captureTime:{display:"flex",alignItems:"center",color:e.palette.grey[500],fontSize:e.typography.pxToRem(12)},buildName:Object(l.a)(Object(l.a)({},e.typography.subtitle2),{},{fontWeight:e.typography.fontWeightLight,margin:0,marginTop:e.spacing(.25),color:e.palette.primary.light,"& code":{color:e.palette.primary.light,fontWeight:"bold"}}),stats:{marginBottom:e.spacing(6)},liveIndicator:{display:"flex",alignItems:"center",marginRight:e.spacing(.5)},recordIcon:{width:16,height:16,marginRight:e.spacing(.5),fill:e.palette.secondary.main},liveLabel:Object(l.a)({},e.typography.caption),historyIcon:{width:14,height:14,marginRight:e.spacing(.5)},summaryStat:{},endpointsHeader:Object(l.a)(Object(l.a)({},e.typography.overline),{},{color:"#818892",borderBottom:"1px solid #e3e8ee"}),endpointsList:{margin:e.spacing(0,-2),padding:0,listStyleType:"none"},isUndocumented:{},endpointsListItem:{"&$isUndocumented":{padding:e.spacing(1,0)}},endpointCard:{display:"flex",flexDirection:"column",backgroundColor:"rgba(255,255,255,0)",boxShadow:"none",willChange:"backgroundColor",transition:"0.1s ease-out backgroundColor","$isCurrent &":{margin:e.spacing(1,0),boxShadow:e.shadows[2],backgroundColor:"rgba(255,255,255,1)"}},endpointLink:{flexGrow:1,padding:e.spacing(1,0),textDecoration:"none",color:"inherit","&:hover":{backgroundColor:e.palette.grey[100]},"$isCurrent &":{backgroundColor:"transparent",padding:0,"&:hover":{backgroundColor:"transparent"}}},endpointHeader:{display:"grid",gridTemplateColumns:"max-content 1fr max-content",gridColumnGap:e.spacing(2),alignItems:"center",padding:e.spacing(0,2),willChange:"padding",transition:"0.1s ease-out padding","$isCurrent &":{padding:e.spacing(2,2)}},endpointMethod:{padding:e.spacing(.5),flexGrow:0,flexShrink:0,borderRadius:e.shape.borderRadius,fontWeight:e.typography.fontWeightRegular,"$isUndocumented &":{opacity:.5}},endpointPath:{fontSize:e.typography.pxToRem(13),color:e.palette.primary.main,"$isUndocumented &":{opacity:.8,fontStyle:"italic"}},endpointStats:{display:"flex"},endpointChip:{flexGrow:0,flexShrink:0,height:e.spacing(3),padding:e.spacing(0,1),marginRight:e.spacing(1),borderRadius:e.spacing(1.5),fontSize:e.typography.pxToRem(11),lineHeight:"".concat(e.spacing(3),"px"),"& > strong":{fontSize:e.typography.pxToRem(13)},"$isUndocumented &":{opacity:.6}},endpointDiffsChip:{background:j()(e.palette.error.light).lighten(.3).hex(),color:j()(e.palette.error.dark).darken(.5).hex()},endpointIncompliantChip:{background:j()(e.palette.warning.light).lighten(.3).hex(),color:j()(e.palette.warning.dark).darken(.5).hex()},endpointCompliantChip:{background:j()(e.palette.success.light).lighten(.3).hex(),color:j()(e.palette.success.dark).darken(.5).hex()},isCurrent:{}}})),ye=Object(b.a)((function(e){var t={color:"#fff"};return["GET","POST","PUT","PATCH","DELETE"].reduce((function(n,a){var r=e.palette.httpMethods[a];return n[a]=Object(l.a)(Object(l.a)({},t),{},{backgroundColor:r.dark}),n}),{})})),Ee=v.opticEngine.com.useoptic.coverage;var je=function(e){e.href;var t=e.children,n=Object(u.a)(e,["href","children"]);return s.a.createElement("a",Object.assign({href:"https://calendly.com/opticlabs/optic-setup",target:"_blank"},n),t)},Oe=n(71),we=n(34),xe=n(363),ke=n.n(xe);function Ce(e){var t=e.currentCaptureId,n=e.onCapturesFetched,a=Le(),r=B((function(e){return e.listCaptures()}),[]),i=r.loading,o=r.error,u=r.result,p=Object(c.useMemo)((function(){return function(e){var t=e.map((function(e){var t=Object(x.a)(e.createdAt),n=e.updatedAt&&Object(x.a)(e.updatedAt),a=e.completedAt&&Object(x.a)(e.completedAt),r=!a;return Object(l.a)(Object(l.a)({},e),{},{isActive:r,createdAt:t,updatedAt:n,completedAt:a})})),n=ke()(t,(function(e){return e.isActive?"active":"completed"})),a=_()(n.active||[],(function(e){return-e.createdAt})),r=_()(n.completed||[],(function(e){return-e.completedAt}));return{active:a,completed:r}}(u||[])}),[u]),d=Object(c.useMemo)((function(){return{active:Array.from({length:2},(function(e,t){return t})),completed:Array.from({length:5},(function(e,t){return t}))}}),[]);return Object(c.useEffect)((function(){i||o||n([].concat(Object(we.a)(p.active),Object(we.a)(p.completed)))}),[i,o,p]),s.a.createElement("nav",{className:a.navRoot},(i||p.active.length>0)&&s.a.createElement("div",{className:a.activeCaptures},i?s.a.createElement("ul",{className:a.capturesList},d.active.map((function(e){return s.a.createElement("li",{key:e,className:a.captureListItem},s.a.createElement(Re,{n:e}))}))):s.a.createElement("ul",{className:a.capturesList},p.active.map((function(e){return s.a.createElement("li",{key:e.captureId,className:a.captureListItem},s.a.createElement(Ne,{capture:e,isCurrent:t&&e.captureId===t}))})))),(i||p.completed.length>0)&&s.a.createElement("div",null,i?s.a.createElement("ul",{className:a.capturesList},d.completed.map((function(e){return s.a.createElement("li",{key:e,className:a.captureListItem},s.a.createElement(Se,{n:e}))}))):s.a.createElement("ul",{className:a.capturesList},p.completed.map((function(e){return s.a.createElement("li",{key:e.captureId,className:a.captureListItem},s.a.createElement(Te,{capture:e,isCurrent:t&&e.captureId===t}))})))))}function Ne(e){var t=e.capture,n=t.tags,a=Le(),r=Ae(e.isCurrent),i=n.find((function(e){return"buildId"===e.name})),o=n.find((function(e){return"environmentName"===e.name}))||"unknown",c=new Date;return s.a.createElement(Ie,{capture:t,isCurrent:e.isCurrent},s.a.createElement(Z.a,{className:f()(a.card,a.isActive),ref:r},s.a.createElement("h5",{className:a.buildName},"Build ",s.a.createElement("code",{className:a.buildId},i.value)," in"," ",s.a.createElement("code",null,o.value)),s.a.createElement("div",{className:a.captureTime},s.a.createElement("div",{className:a.liveIndicator},s.a.createElement(K.a,{className:a.recordIcon}),s.a.createElement("span",{className:a.liveLabel},"LIVE")),"since ",Object(O.a)(t.createdAt,c))))}function Te(e){var t=e.capture,n=t.tags,a=Le(),r=Ae(e.isCurrent),i=n.find((function(e){return"buildId"===e.name})),o=n.find((function(e){return"environmentName"===e.name})),c=new Date;return s.a.createElement(Ie,{capture:t},s.a.createElement(Z.a,{className:f()(a.card,a.isComplete)},s.a.createElement("div",{className:a.buildName,ref:r},"Build ",s.a.createElement("code",null,i.value)," in ",s.a.createElement("code",null,o.value)),s.a.createElement("div",{className:a.captureTime},s.a.createElement(Q.a,{className:a.historyIcon}),"ended ",Object(O.a)(t.completedAt,c)," after"," ",Object(w.a)(t.completedAt,t.createdAt))))}function Ie(e){var t=e.capture,n=Le();return s.a.createElement(ne,{className:n.navLink,captureId:t.captureId,activeClassName:n.isCurrent},e.children)}function Re(){var e=Le();return s.a.createElement(ee.a,{variant:"rect",className:e.loadingCapture})}function Se(){var e=Le();return s.a.createElement("div",{className:e.loadingCapture},s.a.createElement(ee.a,{variant:"rect",width:"85%",height:"1.5rem",className:e.loadingCaptureLine}),s.a.createElement(ee.a,{variant:"rect",width:"45%",height:"1rem",className:e.loadingCaptureLine}))}function Ae(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){if(e){if(!t.current)throw Error("CaptureLink Ref must be set in order to scroll it into view upon activation");Object(ce.a)(t.current,{scrollMode:"if-needed",block:"center"})}}),[e]),t}var Le=Object(b.a)((function(e){var t;return{navRoot:{padding:e.spacing(2),flexGrow:1,position:"fixed",width:"inherit",height:"100vh",overflowY:"scroll",borderRight:"1px solid ".concat(e.palette.grey[300]),background:e.palette.grey[100]},activeCaptures:{marginBottom:e.spacing(3)},capturesList:{flexGrow:1,margin:0,padding:0,listStyleType:"none"},captureListItem:{},navLink:{textDecoration:"none"},loadingCapture:{height:"5rem",marginBottom:e.spacing(2)},loadingCaptureLine:{marginBottom:e.spacing(1.5)},card:(t={display:"flex",flexDirection:"column",alignItems:"flex-start",padding:e.spacing(2),marginBottom:e.spacing(1.5),boxShadow:"0 2px 4px 0 rgba(138, 148, 159, 0.3)",willChange:"transform,box-shadow,margin-bottom",transform:"translateX(0)",transition:"0.1s ease-out transform, 0.1s ease-out box-shadow, 0.1s ease-out marginBottom"},Object(p.a)(t,"&$isComplete",{backgroundColor:"transparent",boxShadow:"none"}),Object(p.a)(t,"$navLink:hover &, $navLink:focus &",{boxShadow:"0 2px 4px 0 rgba(138, 148, 159, 0.6)",opacity:1}),Object(p.a)(t,"$navLink$isCurrent &",{borderLeft:"3px solid ".concat(e.palette.updated.main),opacity:1,transform:"translateX(".concat(e.spacing(1),"px)"),boxShadow:["0 2px 4px 0 rgba(138, 148, 159, 0.6)","0 4px 8px 2px rgba(138, 148, 159, 0.15)"].join(","),background:"#fff"}),t),isComplete:{},isCurrent:{},isActive:{},buildName:{"& code":{color:e.palette.primary.light},"$isActive &":Object(l.a)(Object(l.a)({},e.typography.subtitle1),{},{fontWeight:e.typography.fontWeightLight,margin:0,marginBottom:e.spacing(.75),"& code":{fontWeight:"bold",fontSize:e.typography.subtitle2.fontSize}})},captureTime:{display:"flex",alignItems:"center",color:e.palette.grey[500],fontSize:e.typography.pxToRem(12)},liveIndicator:{display:"flex",alignItems:"center",marginRight:e.spacing(.5)},recordIcon:{width:16,height:16,marginRight:e.spacing(.5),fill:e.palette.secondary.main},liveLabel:Object(l.a)({},e.typography.caption),historyIcon:{width:14,height:14,marginRight:e.spacing(.5)},envTag:{display:"flex",justifyContent:"center",fontSize:e.typography.pxToRem(12)},envTagName:{display:"flex",alignItems:"center",height:e.spacing(2.5),background:e.palette.grey[100],border:"1px solid ".concat(e.palette.grey[200]),borderTopLeftRadius:4,borderBottomLeftRadius:4,paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},envTagVal:{display:"flex",alignItems:"center",height:e.spacing(2.5),paddingLeft:e.spacing(1),paddingRight:e.spacing(1),borderTopRightRadius:4,borderBottomRightRadius:4,background:e.palette.primary.light,color:"#fff"}}}));var De=n(95),Fe=n(747),Pe=n(742),Ue=n.n(Pe);function Me(){var e=qe();return s.a.createElement(Z.a,{className:e.promo},s.a.createElement(Fe.a,{className:e.promoDiagram,image:Ue.a}),s.a.createElement("h2",null,"Confidence your API is working as designed"),s.a.createElement("p",null,"Optic's Live Contract Testing validates your API is working as designed in all your environments. Achieve 100% test coverage of the API's contract from your live traffic."))}var qe=Object(b.a)((function(e){var t;return{promo:(t={width:"100%",padding:e.spacing(2,3)},Object(p.a)(t,e.breakpoints.up("md"),{width:e.breakpoints.values.md/4*3}),Object(p.a)(t,"& h2",Object(l.a)(Object(l.a)({},e.typography.h2),{},{fontSize:e.typography.h4.fontSize,color:e.palette.primary.main,margin:e.spacing(4,0,2)})),Object(p.a)(t,"& p",Object(l.a)(Object(l.a)({},e.typography.subtitle1),{},{fontWeight:e.typography.fontWeightLight})),t),promoDiagram:{height:250,margin:e.spacing(-2,-3,3),backgroundSize:"cover",backgroundPosition:"top center"}}})),He=Symbol();function Je(e){var t=e.match,n=e.service,a=!!n,r=t.url,i=$e(),l=Object(De.a)(),u=Object(c.useMemo)((function(){var t=Object(g.f)(e.location.pathname,l.testingCapture);return t&&t.params.captureId}),[e.location.pathname,l.testingCapture]),m=Object(c.useMemo)((function(){return{service:(e={service:n,baseUrl:r}).service,baseUrl:e.baseUrl};var e}),[a,r]),h=Object(c.useState)(He),b=Object(o.a)(h,2),v=b[0],y=b[1],E=Object(c.useCallback)((function(e){e&&e.length<1||y(e&&e[0])})),j=v===He||!!v;return a?s.a.createElement(z,{value:m},s.a.createElement(k.a,{title:"Live Contracting Dashboard"},s.a.createElement(k.a.Navbar,{mini:!0}),s.a.createElement(k.a.Body,{padded:!1},s.a.createElement("div",{className:f()(i.root,Object(p.a)({},i.isEmpty,!j))},s.a.createElement("div",{className:i.navigationContainer},s.a.createElement(Ce,{currentCaptureId:u,onCapturesFetched:E})),j?s.a.createElement("div",{className:i.reportContainer},s.a.createElement(g.d,null,s.a.createElement(g.b,{strict:!0,path:l.testingEndpointDetails,component:We}),s.a.createElement(g.b,{strict:!0,path:l.testingCapture,component:We}),v!==He&&v?s.a.createElement(g.a,{replace:!0,to:"".concat(r,"/captures/").concat(v.captureId)}):s.a.createElement(be,null))):s.a.createElement(Be,{assertion:"No live captures have been found yet."}))))):s.a.createElement(d.a,null)}function ze(){return s.a.createElement(k.a,{title:"Live Contracting Dashboard"},s.a.createElement(k.a.Navbar,{mini:!0}),s.a.createElement(k.a.Body,{padded:!1},s.a.createElement(Be,null)))}function Be(e){var t=e.assertion,n=$e();return t||(t="Live Contract Testing has not been setup yet."),s.a.createElement("div",{className:n.setup},s.a.createElement("div",{className:n.setupInstructions},s.a.createElement("h3",null,t),s.a.createElement("p",null,"For help on getting started with Live Contract Testing, see"," ",s.a.createElement(je,null,"the setup instructions"),"."),s.a.createElement("p",null,"Think this might not be right? Feel free to"," ",s.a.createElement("a",{href:Oe.b("Problem: ".concat(t))},"contact us about it"),".")),s.a.createElement(Me,null))}function We(e){var t=e.match.params,n=t.captureId,a=t.endpointId,r=B((function(e){return e.loadReport(n)}),[n]),i=r.loading,o=r.result,p=r.error,d=r.notFound,m=function(e){var t=B((function(t){return t.loadSpecEvents(e)}),[e]),n=t.result,a=Object(u.a)(t,["result"]),r=Object(c.useMemo)((function(){return n?function(e){var t=H(e).queries;return Object(h.e)(t)}(n):null}),[n]);return Object(l.a)(Object(l.a)({},a),{},{result:r})}(n),f=m.loading,g=m.result,b=m.error,v=B((function(e){return e.loadCapture(n)}),[n]),y=v.loading,E=v.result,j=v.error,O=v.notFound,w=B((function(e){return e.loadUndocumentedEndpoints(n)}),[n]),x=w.loading,k=w.result,C=w.error,N=w.notFound,T=p||b||j||C;if(T)throw T;return d||O||N?s.a.createElement(Ge,null):s.a.createElement(s.a.Fragment,null,(i||f||y||x)&&s.a.createElement(be,null),o&&g&&E&&k&&s.a.createElement(fe,{report:o,spec:g,capture:E,currentEndpointId:a,undocumentedEndpoints:k}))}function Ge(e){var t=$e();return s.a.createElement("div",{className:t.notFound},s.a.createElement("h4",null,"The Report you're trying to access could not be found."),s.a.createElement("p",null,"Looking for the right report? All available reports are listed in the navigation on the left."),s.a.createElement("p",null,"Think this might not be right? Feel free to"," ",s.a.createElement("a",{href:Oe.b("Problem: Report not found")},"contact us about it"),"."))}var $e=Object(b.a)((function(e){var t,n,a;return{root:(t={display:"flex",flexGrow:1},Object(p.a)(t,e.breakpoints.down("sm"),{flexDirection:"column"}),Object(p.a)(t,e.breakpoints.up("sm"),{flexDirection:"row"}),t),isEmpty:{},navigationContainer:(n={width:"100%",flexGrow:0,flexShrink:0,display:"flex"},Object(p.a)(n,e.breakpoints.up("sm"),{width:e.breakpoints.values.sm/3*2}),Object(p.a)(n,"$isEmpty &",{display:"none"}),n),reportContainer:{display:"flex",flexGrow:1,flexShrink:1,justifyContent:"center"},setup:Object(p.a)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},e.breakpoints.down("md"),{padding:e.spacing(0,3)}),setupInstructions:(a={width:"100%",marginBottom:e.spacing(3)},Object(p.a)(a,e.breakpoints.up("md"),{padding:e.spacing(2,3),width:e.breakpoints.values.md/4*3}),Object(p.a)(a,"& h3",Object(l.a)(Object(l.a)({},e.typography.h4),{},{color:e.palette.primary.main})),Object(p.a)(a,"& p",Object(l.a)(Object(l.a)({},e.typography.body1),{},{fontWeight:e.typography.fontWeightLight})),a),notFound:{padding:e.spacing(3,4),"& h4":Object(l.a)(Object(l.a)({},e.typography.h4),{},{color:e.palette.primary.main}),"& p":Object(l.a)(Object(l.a)({},e.typography.body1),{},{fontWeight:e.typography.fontWeightLight})}}}));var _e=n(84),Ve=n(51),Xe=n(743),Qe=n.n(Xe),Ye=function(){function e(t,n){Object(C.a)(this,e),this.fetchAuthToken=t,this.baseUrl=n,this.authToken=void 0,this.refreshing=void 0,this.refreshAuth()}return Object(N.a)(e,[{key:"callApi",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,o,c,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},a=new Headers(n.headers||{}),i=this.authToken,o=Qe()(this.baseUrl,t),i){e.next=7;break}return e.next=7,this.refreshAuth();case 7:return a.set("Authorization","Bearer ".concat(this.authToken)),e.next=10,fetch(o,Object(l.a)(Object(l.a)({},n),{},{headers:a}));case 10:return(c=e.sent).ok||401!==c.status||this.refreshAuth(),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshAuth",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.refreshing||(t=function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchAuthToken();case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Could not fetch testing credentials required to use TestingService");case 5:return e.next=7,t.json();case 7:if((a=e.sent).authToken){e.next=10;break}throw new Error("Could not fetch usable testing credentials to use Testing Service");case 10:n.authToken=a.authToken,n.refreshing=null;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.refreshing=t()),e.abrupt("return",this.refreshing);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"listCaptures",value:function(){var e=Object(i.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callApi("/captures");case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("List of captures could not be fetched");case 5:return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",F(n.captures));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCapture",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callApi("/captures/".concat(t));case 2:if((n=e.sent).ok){e.next=9;break}if(404!==n.status){e.next=8;break}return e.abrupt("return",P(new A));case 8:throw new Error("Capture could not be fetched");case 9:return e.next=11,n.json();case 11:return a=e.sent,e.abrupt("return",F(a));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadReport",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callApi("/captures/".concat(t,"/reports/coverage"));case 2:if((n=e.sent).ok){e.next=9;break}if(404!==n.status){e.next=8;break}return e.abrupt("return",P(new A));case 8:throw new Error("CoverageReport for capture could not be fetched");case 9:return e.next=11,n.json();case 11:return a=e.sent,i=v.opticEngine.CoverageReportJsonDeserializer.fromJs(a),o=new v.opticEngine.com.useoptic.CoverageReportConverter(U.StableHasher),c=o.toJs(i),e.abrupt("return",F(c));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadUndocumentedEndpoints",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callApi("/captures/".concat(t,"/reports/undocumented-urls"));case 2:if((n=e.sent).ok){e.next=9;break}if(404!==n.status){e.next=8;break}return e.abrupt("return",P(new A));case 8:throw new Error("Undocumented endpoints for capture could not be fetched");case 9:return e.next=11,n.json();case 11:return a=e.sent,e.abrupt("return",F(a));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSpecEvents",value:function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callApi("/captures/".concat(t,"/spec"));case 2:if((n=e.sent).ok){e.next=9;break}if(404!==n.status){e.next=8;break}return e.abrupt("return",P(new A));case 8:throw new Error("Spec for capture could not be fetched");case 9:return e.next=11,n.json();case 11:return a=e.sent,e.abrupt("return",F(a));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ke={baseUrl:"/api/testing"};function Ze(e){var t=Object(_e.b)(),n=Object(c.useState)(null),a=Object(o.a)(n,2),l=a[0],u=a[1],p=Object(Ve.e)(),d=Object(Ve.c)();return Object(c.useEffect)((function(){if(!(t.available&&t.loading||!d)&&d.TESTING_DASHBOARD){var e=t.available?function(){return function(e){return et.apply(this,arguments)}(t.data)}:Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Ye(p.getTestingCredentials.bind(p),Ke.baseUrl));case 1:case"end":return e.stop()}}),e)})));(function(){var t=Object(i.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:n=t.sent,u(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}}),[t.available,t.loading,p]),d&&!d.TESTING_DASHBOARD?s.a.createElement(ze,null):s.a.createElement(Je,Object.assign({service:l},e))}function et(){return(et=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.refs&&t.refs.find((function(e){return"example-reports"===e.rel})),e.abrupt("return",M(n&&n.id));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.d(t,"default",(function(){return Ze}))}}]);
//# sourceMappingURL=4.ef7bd5e1.chunk.js.map